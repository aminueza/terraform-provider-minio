---
page_title: "Resource minio_s3_bucket_object_lock_configuration - minio"
subcategory: ""
description: |-
  Configures object lock (WORM) retention policies at the bucket level. Sets default retention that applies to all new objects automatically.
  Object locking must be enabled when creating the bucket - can't add it later unless you're on MinIO RELEASE.2025-05-20T20-30-00Z+.
  Useful for compliance: SEC17a-4(f), FINRA 4511(C), CFTC 1.31(c)-(d)
---

# Resource: minio_s3_bucket_object_lock_configuration

Configures object lock (WORM) retention policies at the bucket level. Sets default retention that applies to all new objects automatically.

Object locking must be enabled when creating the bucket - can't add it later unless you're on MinIO RELEASE.2025-05-20T20-30-00Z+.

Useful for compliance: SEC17a-4(f), FINRA 4511(C), CFTC 1.31(c)-(d)

Cleaner alternative to `minio_s3_bucket_retention` with a nested schema structure that matches the API better.

## Differences from minio_s3_bucket_retention

- More intuitive naming
- Nested `rule { default_retention { } }` blocks instead of flat structure
- Explicit `object_lock_enabled` field
- Choose `days` or `years` in the same block

## Retention Modes

### GOVERNANCE
Users with `s3:BypassGovernanceRetention` can override the lock. Good for backups and internal policies where you might need escape hatches.

### COMPLIANCE
Strict mode - nobody can override, not even root. Can't delete or modify objects until retention expires. Use for regulatory requirements (SEC, FINRA, CFTC) and legal holds.

## Prerequisites

Object locking must be enabled at bucket creation. Can't add it later unless you're on MinIO RELEASE.2025-05-20T20-30-00Z+.

```hcl
resource "minio_s3_bucket" "example" {
  bucket         = "my-bucket"
  object_locking = true  # Must be true
}
```

## Example Usage

```terraform
# Create a bucket with object locking enabled
resource "minio_s3_bucket" "compliance_bucket" {
  bucket         = "compliance-data"
  object_locking = true
}

# Configure default retention policy with days
resource "minio_s3_bucket_object_lock_configuration" "compliance" {
  bucket              = minio_s3_bucket.compliance_bucket.bucket
  object_lock_enabled = "Enabled"

  rule {
    default_retention {
      mode = "COMPLIANCE"
      days = 2555 # 7 years in days
    }
  }
}

# Example with years for financial records
resource "minio_s3_bucket" "financial_records" {
  bucket         = "financial-records"
  object_locking = true
}

resource "minio_s3_bucket_object_lock_configuration" "financial" {
  bucket = minio_s3_bucket.financial_records.bucket

  rule {
    default_retention {
      mode  = "COMPLIANCE"
      years = 7
    }
  }
}

# Example with GOVERNANCE mode for backups
resource "minio_s3_bucket" "backup_bucket" {
  bucket         = "daily-backups"
  object_locking = true
}

resource "minio_s3_bucket_object_lock_configuration" "backups" {
  bucket = minio_s3_bucket.backup_bucket.bucket

  rule {
    default_retention {
      mode = "GOVERNANCE"
      days = 90
    }
  }
}
```

## Common Uses

- Ransomware-proof backups (immutable)
- Financial records (SEC17a-4(f), FINRA 4511(c), CFTC 1.31)
- HIPAA medical records
- Audit logs and security compliance
- Legal holds for e-discovery

## Migrating from minio_s3_bucket_retention

```hcl
# Old (flat structure)
resource "minio_s3_bucket_retention" "old" {
  bucket          = "my-bucket"
  mode            = "GOVERNANCE"
  unit            = "DAYS"
  validity_period = 30
}

# New (nested structure)
resource "minio_s3_bucket_object_lock_configuration" "new" {
  bucket = "my-bucket"

  rule {
    default_retention {
      mode = "GOVERNANCE"
      days = 30
    }
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `bucket` (String) Bucket name. Must have object locking enabled at creation time.

### Optional

- `object_lock_enabled` (String) Object lock status. Only valid value is 'Enabled'.
- `rule` (Block List, Max: 1) Retention rule configuration (see [below for nested schema](#nestedblock--rule))

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--rule"></a>
### Nested Schema for `rule`

Required:

- `default_retention` (Block List, Min: 1, Max: 1) Default retention applied to all new objects (see [below for nested schema](#nestedblock--rule--default_retention))

<a id="nestedblock--rule--default_retention"></a>
### Nested Schema for `rule.default_retention`

Required:

- `mode` (String) GOVERNANCE (bypassable with permissions) or COMPLIANCE (strict, no overrides)

Optional:

- `days` (Number) Retention period in days. Mutually exclusive with years.
- `years` (Number) Retention period in years. Mutually exclusive with days.

## Notes

- Versioning is required (gets enabled automatically with object locking)
- Object locking can't be disabled once enabled
- Default retention applies to all new objects
- Per-object retention can override bucket defaults
- Deletes create markers instead of actually removing data during retention
